%% Filtro IIR forma directa II en paralelo

A = [ 1.000000000000000   3.008607216699280   7.192774071191725  11.962515313651629  16.410929419412419  18.331457261503523  17.307140588189100  13.789675633578121  9.326578686420685   5.318942064556707   2.532316950275711   0.986602478570769   0.304571227945205   0.070435436726314   0.010949376248180   0.000867911895226];
B = [ 0.029460350452806   0.230149530197488   0.961493159207989   2.767223646662040   6.051851428272983  10.564499483003152  15.129019762146143  18.043484458489694  18.043484458489694  15.129019762146143  10.564499483003150   6.051851428272983   2.767223646662040   0.961493159207989   0.230149530197488   0.029460350452806]; 


b =[0.036362595130316   0.150471726239123  0
    0.768521556540110   0.184408881313714  0
    1.326535488709074  -1.164591836040440  0
   -1.910876557499526  -2.920053780601103  0
   -7.165664232604868  -1.930622960083425  0
   -5.112173675390041   1.491558268062217  0
    5.873354288904356   4.083446105320340  0
    6.325455443428623                   0  0
    0.000                   0  0];


a =[1.000000000000000   0.073891862143598   0.906525463841709
    1.000000000000000   0.127227393734486   0.739522331388364
    1.000000000000000   0.226117952685246   0.589975172400225
    1.000000000000000   0.355720758852900   0.453389502331096
    1.000000000000000   0.497670639504678   0.331711356347697
    1.000000000000000   0.628427111246174   0.232395924132821
    1.000000000000000   0.721710253614879   0.166165528522665
    1.000000000000000   0.377841244917318                   0
    0                                   0                   0];

kf = 0.02946035045280;

Nf = length(b(:,1))-1;
Nc = 3;

%señal de entrada
x = [.23 .26 .2 .3 .03 .09 .08];

%Inicializamos variables
a1 = 0;
a2 = 0;

v(1:Nf,1:Nc) = 0;

y = 0;

v_temp = 0;

%Forma Directa 2
for n = 1 : length(x)
    
    acu = 0;
    
    for numF = 1 : Nf
    
        a1 = 0;
        a2 = 0;

        for j = 2 : Nc
            a1 = a1 + a(numF,j) * v(numF,j-1);
        end

        for k = Nc : -1 : 2
            v(numF,k) = v(numF,k-1);
        end

        v(numF,1) = x(n) - a1;

        for k = 1 : Nc
            a2 = a2 + b(numF,k)*v(numF,k);
        end

        acu = acu + a2;
                
    end
    
    y(n) = acu;   
    
end

Filter


y

yy = filter(B,A,x)

