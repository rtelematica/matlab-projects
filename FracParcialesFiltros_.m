Den = [ 1.0000    1.5948    2.1945    1.7843    0.9940    0.3201 ];
Num = [ 0.5660    1.3270    2.0508    2.0508    1.3270    0.5660 ];

%Num = [ 0.000000007294421   0.000000160477263   0.000001685011260   0.000011233408400   0.000053358689900   0.000192091283639   0.000544258636977   0.001244019741662  0.002332537015616   0.003628390913181   0.004716908187135   0.005145718022330   0.004716908187135   0.003628390913181   0.002332537015616   0.001244019741662  0.000544258636977   0.000192091283639   0.000053358689900   0.000011233408400   0.000001685011260   0.000000160477263   0.000000007294421];
%Den = 1.0e+003 * [ 0.001000000000000  -0.008203624412074
%0.038204667512548  -0.127538728541497   0.335619498045386  -0.731042170185118   1.357236876260020  -2.188483307542059 3.103324142913966  -3.902158256052586   4.373700640885471  -4.382074833439184   3.927359626974218  -3.144381916693860   2.241169324425919  -1.413587367603630  0.781803117660704  -0.374019875275884   0.151671807191240  -0.050521370187640   0.013116397589000  -0.002399777773491   0.000239456424863 ];

[r,p,k] = residue(Num, Den);

ac = 0;
bc = 0;
a = 0;
b = 0;

l = length(r);

ind = 1;

if mod(l,2) == 0 
    display('Es par')
    
    for n = 1 : 2 : l-1        
        
        [bc, ac] = residue([r(n),r(n+1)],[p(n),p(n+1)],0);
        
           for i = 1 : length(bc)
               bc(i) = abs(bc(i));
           end
           for i = 1 : length(ac)
               ac(i) = abs(ac(i));
           end
        
        b(ind, 1:2) = bc;
        a(ind, 1:3) = ac;
        
        ind = ind + 1;

    end
    
else
    display('Es impar')
     
    for n = 1 : 2 : l-2
       
        [bc, ac] = residue([r(n),r(n+1)],[p(n),p(n+1)],0);
        
        for i = 1 : length(bc)
            bc(i) = abs(bc(i));
        end
        for i = 1 : length(ac)
            ac(i) = abs(ac(i));
        end        
        b(ind, 1:2) = bc;
        a(ind, 1:3) = ac;
        
        ind = ind + 1;

    end
    
     [bc, ac] = residue(r(l),p(l),0);

     b(ind, 1:2) = [bc 0];
     a(ind, 1:3) = [ac 0];
end

t = length(b(:,1));

rel = 0;
rel(1:t,:) = 0
b1 = [rel b];

b1(t,:) = [ k 0 0];
a(t,:) = [ 1 0 0];


