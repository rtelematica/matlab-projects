k=0.5660;   

 b = [0.1617     0.3310 0  
      -0.0539    0.1185 0  
       0.3165    0      0
       k         0      0];
 
 a = [1  0.7726  0.5813
        1  0.1827  0.8611
        1  0.6395   0
        1  0 0  ];
    
x = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];

N=2;
Nr=4;

%buf_v1(1:N+1)=0;
%buf_v2(1:N+1)=0;

y=0;
v=0;
s1=0;
s2=0;
fil=0;
acu = 0;
for i = 1 : Nr
    for j = 1 : N + 1
        v(i,j)=0;
    end
end

for n = 1 : length(x)

   for  fil = 1 : Nr
        
       s1 = 0;
       s2 = 0;
       
       for j = 2 : N+1 
               s1 = s1 + a(fil,j) * v(fil,j-1);        
       end

       % ?????
       for  k = N+1 : -1 : 2 
            v(fil,k) = v(fil,k-1);
        end                        

        v(1) =  x(n) - s1;

        for k = 1 : N + 1            
              s2 = s2 + b(fil,k) * v(fil,k);                        
        end    

        acu = acu + s2;                
   
   end  
   
   y(n) = acu;
   acu = 0;
   
end
y

a1=[1 -1.5948 -2.1945 -1.7842 -0.9940 -0.3201];
b1=[0.5660 1.3270 2.0508 2.0508 0.9940 0.3201];

yy = filter(b1,a1,x)